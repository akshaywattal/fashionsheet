<!DOCTYPE html>
<html lang="en">
   
   <!-- Header of the html by AW-->
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="">
      <meta name="author" content="">
      <title>StyleSheet</title>
      <!-- Bootstrap Core CSS -->
      <link href="css/bootstrap.min.css" rel="stylesheet">
      <!-- Custom CSS -->
      <link href="css/heroic-features.css" rel="stylesheet">
   </head>

   <!-- Body of the html by AW-->
   <body>

      <!-- Navigation -->
      <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
         <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="#">StyleSheet</a>
            </div>
         </div>
         <!-- /.container -->
      </nav>
      <!-- Page Content -->

      <div class="container">
         <!-- Jumbotron Header -->
         <header class="jumbotron hero-spacer">
            <h1>A Warm Welcome!</h1>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa, ipsam, eligendi, in quo sunt possimus non incidunt odit vero aliquid similique quaerat nam nobis illo aspernatur vitae fugiat numquam repellat.</p>
            <p><a class="btn btn-primary btn-large">Call to action!</a>
            </p>
         </header>
         <hr>
         <!-- Title -->
         <div class="row">
            <div class="col-lg-12">
               <h3>Latest Features</h3>
            </div>
         </div>
         <!-- /.row -->
         <!-- Page Features -->
         <div id="pinholder" class="row text-center">
         </div>
         <!-- /.row -->
         <hr>
         <!-- Footer -->
         <footer>
            <div class="row">
               <div class="col-lg-12">
                  <p>Copyright &copy; Your Website 2014</p>
               </div>
            </div>
         </footer>
      </div>
      <!-- /.container -->

      <!-- jQuery -->
      <script src="js/jquery.js"></script>
      <!-- Bootstrap Core JavaScript -->
      <script src="js/bootstrap.min.js"></script>
      <!-- Custom js script to get data from DB, via AJAX call -->
      <script>

        // Global id tracker for Pin's components
        var idTracker = 1;

        // Function to call get Pins
        function getPinListFunction(pageParameter){
            $.ajax({
                url: "http://localhost/server_processing_getpinlist.php?page_number=" + pageParameter,
                type: "GET",
                dataType: "jsonp"
                })
                .done(function( data ) {
                    // Storing the count of the records in reponse
                    var recordsCount = data["data"].length;

                    // Loop over count and dynamically render the pins on the html page
                    for ( var i=0; i<recordsCount; i++ ) {

                        // Dynamically add custom div
                        $( "#pinholder" ).append( '<div id="pin" class="col-md-3 col-sm-6 hero-feature"><div class="thumbnail"><img id="thumbnail_url'+ idTracker +'" src="http://placehold.it/800x500" alt=""><div class="caption"><h3 id="title'+ idTracker +'">Title:</h3><h4 id="author'+ idTracker +'">Author:</h4><p id="blurb'+ idTracker +'">Description:</p><p><a id="details_url" href="#" class="btn btn-default">More Info</a></p></div></div></div>' );

                        // Set value on the above div's dynamically
                        $("#title" + idTracker).text('Title: ' +data["data"][i]["title"]);
                        $("#author" + idTracker).text('Author: ' +data["data"][i]["author"]);
                        $("#blurb" + idTracker).text('Description: ' +data["data"][i]["blurb"]);
                        $("#thumbnail_url" + idTracker).attr("src", data["data"][i]["thumbnail_url"]);
                        idTracker++;
                     };
                 })
                 .fail(function() {
                    alert( "Error Occured..." );
                });
        }

        $(document).ready(function () {

            // Variables defined for pagination and grouping
            var pageParameter = 0;
            var totalPages = 2; // This means 0,1,2 - 3 pages. Harcoded for now.
            
            // Calling the get pins function on page load
            getPinListFunction(pageParameter);
            pageParameter++;

            // Function to detect page scroll
            $(window).scroll(function() { 
                if($(window).scrollTop() + $(window).height() == $(document).height())  
                {
                    if(pageParameter < totalPages)
                    {   
                        getPinListFunction(pageParameter);
                        pageParameter ++;
                    
                    }
                }
            });
        });
      </script>

   </body>
</html>